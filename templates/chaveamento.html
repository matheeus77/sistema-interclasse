<!-- {% include 'head.html' %}

<head>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<main class="card-container">

     LISTA DE CHAVEAMENTOS -->
    <!-- <section class="table-section">
        <div class="header-actions">
            <h2>Chaveamento</h2>
            <button id="btnGerarChaveamento" class="btn btn-primary">Gerar Chaveamento</button>
        </div>
        <br> -->

        <!-- SELEÇÃO DO ESPORTE -->
        <!-- <div class="form-group">
            <label for="esporte">Selecione o Esporte:</label>
            <select id="esporte" name="esporte" onchange="carregarEquipesEsporte(this.value)">
                <option value="">Selecione</option>
                {% for esporte in esportes %}
                <option value="{{ esporte['pk_esporte'] }}">{{ esporte['pk_esporte'] }}</option>
                {% endfor %}
            </select>
        </div>
        <br> -->

        <!-- TABELA DE EQUIPES NO CHAVEAMENTO -->
        <!-- <table class="styled-table" id="tabelaChaveamento">
            <thead>
                <tr>
                    <th>Equipe</th>
                    <th>Turma</th>
                    <th>Classificação</th>
                    <th>Jogadores</th>
                </tr>
            </thead>
            <tbody id="listaEquipes">
                <tr>
                    <td colspan="4">Selecione um esporte para carregar as equipes.</td>
                </tr>
            </tbody>
        </table>
    </section>
</main> -->

<!-- MODAL DE JOGADORES -->
<!-- <div id="modalJogadores" class="modal">
    <div class="modal-content">
        <span id="closeJogadores" class="close">&times;</span>
        <h2 id="tituloEquipe"></h2>
        <h3>Jogadores da Equipe</h3>
        <ul id="listaJogadores"></ul>
    </div>
</div>

<script> -->
    <!-- // Carregar equipes de um esporte
    function carregarEquipesEsporte(esporte) {
        if (!esporte) return;

        fetch(`/equipesPorEsporte/${esporte}`)
            .then(res => res.json())
            .then(data => {
                const tbody = document.getElementById("listaEquipes");
                tbody.innerHTML = "";
                if (data.equipes.length === 0) {
                    tbody.innerHTML = "<tr><td colspan='4'>Nenhuma equipe cadastrada para este esporte.</td></tr>";
                } else {
                    data.equipes.forEach(eq => {
                        let row = `
                            <tr>
                                <td>${eq.nome}</td>
                                <td>${eq.turma}</td>
                                <td>${eq.descricao}</td>
                                <td>
                                    <button class="btn btn-primary" onclick="abrirModalJogadores(${eq.id}, '${eq.nome}')">
                                        Ver Jogadores
                                    </button>
                                </td>
                            </tr>
                        `;
                        tbody.innerHTML += row;
                    });
                }
            });
    }

    // Abrir modal de jogadores
    function abrirModalJogadores(idEquipe, nomeEquipe) {
        fetch(`/jogadoresPorEquipe/${idEquipe}`)
            .then(res => res.json())
            .then(data => {
                document.getElementById("tituloEquipe").innerText = nomeEquipe;
                const lista = document.getElementById("listaJogadores");
                lista.innerHTML = "";
                if (data.jogadores.length === 0) {
                    lista.innerHTML = "<li>Nenhum jogador cadastrado</li>";
                } else {
                    data.jogadores.forEach(j => {
                        lista.innerHTML += `<li>${j.nome} (${j.matricula})</li>`;
                    });
                }
                document.getElementById("modalJogadores").style.display = "block";
            });
    }

    // Fechar modal
    document.getElementById("closeJogadores").onclick = () => {
        document.getElementById("modalJogadores").style.display = "none";
    }

    // Exemplo de geração de chaveamento simples (embaralhar equipes)
    document.getElementById("btnGerarChaveamento").onclick = () => {
        const linhas = document.querySelectorAll("#listaEquipes tr");
        if (linhas.length <= 1) {
            alert("Carregue as equipes antes de gerar o chaveamento.");
            return;
        }
        let equipes = Array.from(linhas).map(tr => tr.cells[0].innerText);
        equipes = equipes.sort(() => Math.random() - 0.5); // embaralha

        let chaveamento = "Chaveamento Gerado:\n";
        for (let i = 0; i < equipes.length; i += 2) {
            if (equipes[i + 1]) {
                chaveamento += `${equipes[i]} vs ${equipes[i + 1]}\n`;
            } else {
                chaveamento += `${equipes[i]} (BYE)\n`;
            }
        }
        alert(chaveamento);
    };
</script> -->


<!-- {% include 'footer.html' %} --> 
